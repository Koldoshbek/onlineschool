{% extends 'main/base.html' %}
{% load static %}
{% load i18n %}
{% load widget_tweaks %}
{% block content %}
    <div class="dashboard-content-one">
        <!-- Breadcubs Area Start Here -->
        <div class="breadcrumbs-area">
            <h3>Messaging</h3>
            <ul>
                <li>
                    <a href="admin_page.html">Home</a>
                </li>
                <li>Compose Message</li>
            </ul>
        </div>
        <!-- Breadcubs Area End Here -->
        <div class="row">
            <!-- Add Notice Area Start Here -->
            <div class="col-xl-8">
                <div class="card">
                    <div class="card-body">
                        <div class="heading-layout1">
                            <div class="item-title">
                                <h3>Write New Message</h3>
                            </div>
                            <div class="dropdown">
                                <a class="dropdown-toggle" href="messaging.html#" role="button"
                                   data-toggle="dropdown" aria-expanded="false">...</a>

                                <div class="dropdown-menu dropdown-menu-right">
                                    <a class="dropdown-item" href="messaging.html#"><i
                                            class="fas fa-times text-orange-red"></i>Close</a>
                                    <a class="dropdown-item" href="messaging.html#"><i
                                            class="fas fa-cogs text-dark-pastel-green"></i>Edit</a>
                                    <a class="dropdown-item" href="messaging.html#"><i
                                            class="fas fa-redo-alt text-orange-peel"></i>Refresh</a>
                                </div>
                            </div>
                        </div>
                        <form class="new-added-form" id="contact-form"
                              action="{% url 'send_email' %}" method="post">
                            {% csrf_token %}
                            <div class="row">
                                <div class="col-12 form-group">
                                    <label>Title</label>
                                    <input type="text" placeholder="" id="title" name="title" class="form-control">
                                </div>
                                <div class="col-12 form-group">
                                    <label>Recipient</label>
                                    <input type="text" placeholder="" id="email" name="email" class="form-control">
                                </div>
                                <div class="col-12 form-group">
                                    <label>Message</label>
                                    <textarea class="textarea form-control" name="message" id="form-message" cols="10"
                                              rows="9"></textarea>
                                </div>
                                <div class="col-12 form-group mg-t-8">
                                    <button id="send-mail" class="btn-fill-lg btn-gradient-yellow btn-hover-bluedark">
                                        Send
                                    </button>

                                    <button type="reset" class="btn-fill-lg bg-blue-dark btn-hover-yellow">Reset
                                    </button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <!-- Add Notice Area End Here -->
            <!-- All Notice Area Start Here -->
            <div class="col-xl-4">
                <div class="card message-box-wrap height-auto">
                    <div class="card-body">
                        <div class="heading-layout1">
                            <div class="item-title">
                                <h3>Successful Message</h3>
                            </div>
                            <div class="dropdown">
                                <a class="dropdown-toggle" href="messaging.html#" role="button"
                                   data-toggle="dropdown" aria-expanded="false">...</a>

                                <div class="dropdown-menu dropdown-menu-right">
                                    <a class="dropdown-item" href="messaging.html#"><i
                                            class="fas fa-times text-orange-red"></i>Close</a>
                                    <a class="dropdown-item" href="messaging.html#"><i
                                            class="fas fa-cogs text-dark-pastel-green"></i>Edit</a>
                                    <a class="dropdown-item" href="messaging.html#"><i
                                            class="fas fa-redo-alt text-orange-peel"></i>Refresh</a>
                                </div>
                            </div>
                        </div>
                        <div class="message-success-box">
                            <div class="item-content">
                                <div class="item-icon">
                                    <i class="fas fa-check"></i>
                                </div>
                                <h3 class="item-title">Successfully Message Sent</h3>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="card message-box-wrap height-auto">
                    <div class="card-body">
                        <div class="heading-layout1">
                            <div class="item-title">
                                <h3>Error Message</h3>
                            </div>
                            <div class="dropdown">
                                <a class="dropdown-toggle" href="messaging.html#" role="button"
                                   data-toggle="dropdown" aria-expanded="false">...</a>

                                <div class="dropdown-menu dropdown-menu-right">
                                    <a class="dropdown-item" href="messaging.html#"><i
                                            class="fas fa-times text-orange-red"></i>Close</a>
                                    <a class="dropdown-item" href="messaging.html#"><i
                                            class="fas fa-cogs text-dark-pastel-green"></i>Edit</a>
                                    <a class="dropdown-item" href="messaging.html#"><i
                                            class="fas fa-redo-alt text-orange-peel"></i>Refresh</a>
                                </div>
                            </div>
                        </div>
                        <div class="message-error-box">
                            <div class="item-content">
                                <div class="item-icon">
                                    <i class="fas fa-exclamation-circle"></i>
                                </div>
                                <h3 class="item-title">Some Field Requierd Here</h3>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- All Notice Area End Here -->
        </div>
        <footer class="footer-wrap-layout1">
            <div class="copyright">Â© Copyrights <a href="messaging.html#">akkhor</a> 2019. All rights reserved. Designed
                by
                <a href="messaging.html#">PsdBosS</a></div>
        </footer>
        <script>
            $("#send-mail").click(function () {
                var name = $('input#title').val(); // get the value of the input field
                var error = false;
                if (name == "" || name == " ") {
                    $('#err-name').show(500);
                    $('#err-name').delay(4000);
                    $('#err-name').animate({
                        height: 'toggle'
                    }, 500, function () {
                        // Animation complete.
                    });
                    error = true; // change the error state to true
                }


                var emailCompare = /^([a-z0-9_.-]+)@([da-z.-]+).([a-z.]{2,6})$/; // Syntax to compare against input
                var email = $('input#email').val().toLowerCase(); // get the value of the input field
                if (email == "" || email == " " || !emailCompare.test(email)) {
                    $('#err-email').show(500);
                    $('#err-email').delay(4000);
                    $('#err-email').animate({
                        height: 'toggle'
                    }, 500, function () {
                        // Animation complete.
                    });
                    error = true; // change the error state to true
                }


                var comment = $('textarea#form-message').val(); // get the value of the input field
                if (comment == "" || comment == " ") {
                    $('#err-comment').show(500);
                    $('#err-comment').delay(4000);
                    $('#err-comment').animate({
                        height: 'toggle'
                    }, 500, function () {
                        // Animation complete.
                    });
                    error = true; // change the error state to true
                }

                if (error == false) {
                    var dataString = $('#contact-form').serialize(); // Collect data from form
                    $.ajax({
                        type: "POST",
                        url: $('#contact-form').attr('action'),
                        data: dataString,
                        timeout: 6000,

                        error: function (request, error) {
                            $('#show_error_toastr').show();
                        },
                        success: function () {
                            $('#show_toastr').show();
                            $('#hide_p').hide();
                            $("#name").val('');
                            $("#email").val('');
                            $("#comment").val('');
                            $("#phone_number").val('');
                        }
                    });
                }

                return false; // stops user browser being directed to the php file
            });
        </script>
    </div>

{% endblock %}